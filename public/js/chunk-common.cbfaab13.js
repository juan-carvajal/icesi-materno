(self["webpackChunkicesi_materno"]=self["webpackChunkicesi_materno"]||[]).push([[64],{53786:(e,a,o)=>{"use strict";var t,r,l;o.d(a,{bl:()=>t,jr:()=>r,dh:()=>l}),function(e){e["MEDICAL"]="Médico",e["ADMINISTRATIVE"]="Administrativo"}(t||(t={})),function(e){e["TODO"]="Por Hacer",e["IN_PROGRESS"]="En Progreso",e["BLOCKED"]="Bloqueados",e["RESOLVED"]="Resueltos"}(r||(r={})),function(e){e[e["LOW"]=0]="LOW",e[e["NORMAL"]=1]="NORMAL",e[e["HIGH"]=2]="HIGH"}(l||(l={}))},23470:(e,a,o)=>{"use strict";o.d(a,{Z7:()=>i,VY:()=>n,Ob:()=>c});var t=o(9594),r=o(83673),l=o(61442),s=o(12942);function i(e=50,...a){const o=(0,t.iH)([]),i=(0,l.IO)((0,l.hJ)(s.db,"alerts"),(0,l.Xo)("createdAt","desc"),(0,l.b9)(e),...a),n=(0,l.cf)(i,(e=>{o.value=[],e.forEach((e=>{const a=e.data();a.id=e.id,o.value.push(a)}))}));return(0,r.Ah)(n),{alerts:o}}function n(e){const a=(0,t.iH)(),o=(0,t.iH)(),i=()=>{o.value&&o.value(),e.value?o.value=(0,l.cf)((0,l.JU)(s.db,"alerts",e.value),(e=>{e.exists?a.value={...e.data(),id:e.id}:a.value=void 0})):a.value=void 0};return(0,r.YP)(e,i,{immediate:!0}),{alert:a}}function c(e,a){return a?(0,l.r7)((0,l.JU)(s.db,"alerts",e),{acknowledgedBy:a,acknowledgedAt:new Date}):Promise.reject("User is required to acknowledge an alert")}},16423:(e,a,o)=>{"use strict";o.d(a,{qs:()=>n,dc:()=>c,s3:()=>u,xJ:()=>d});var t=o(9594),r=o(83673),l=o(61442),s=o(12942),i=o(98511);function n(e){const a=(0,t.iH)(),o=(0,t.iH)(),i=()=>{o.value&&o.value(),e.value?o.value=(0,l.cf)((0,l.JU)(s.db,"roles",e.value),(e=>{e.exists()?a.value=e.data():a.value=void 0})):a.value=void 0};return(0,r.YP)(e,i,{immediate:!0}),{role:a}}function c(){const e=(0,t.iH)([]),a=(0,l.IO)((0,l.hJ)(s.db,"roles"));return(0,l.cf)(a,(a=>{e.value=[],a.forEach((a=>{const o=a.data();o.id=a.id,e.value.push(o)}))})),{roles:e}}function u(){const e=(0,t.iH)([]),a=(0,l.IO)((0,l.hJ)(s.db,"userRoles"));return(0,l.cf)(a,(a=>{e.value=[],a.forEach((a=>{const o=a.data();o.id=a.id,e.value.push(o)}))})),{userRoles:e}}function d(){const e=(0,t.iH)(),a=(0,i.v0)();return a.onAuthStateChanged((a=>{e.value=a??void 0})),{currentUser:e}}},94215:(e,a,o)=>{"use strict";o.d(a,{H:()=>i,J:()=>n});var t=o(61442),r=o(12942),l=o(9594),s=o(83673);function i(e,a){const o=(0,l.iH)(),i=(0,l.iH)(),n=(0,l.iH)(),c=()=>{i.value&&i.value(),e.value&&a.value?i.value=(0,t.cf)((0,t.JU)(r.db,e.value,a.value),(e=>{e.exists?o.value={...e.data(),id:e.id,ID:e.id}:o.value=void 0}),(e=>{console.log(e),n.value=e})):o.value=void 0};return(0,s.YP)([e,a],c,{immediate:!0}),(0,s.Ah)((()=>{i.value&&i.value()})),{docData:o,error:n}}function n(e,...a){const o=(0,l.iH)({}),s=(0,t.IO)((0,t.hJ)(r.db,e),...a),i=(0,l.iH)();return(0,t.cf)(s,(e=>{o.value={},e.forEach((e=>{o.value[e.id]=e.data()}))}),(e=>{console.log(e),i.value=e})),{docs:o,error:i}}},30932:(e,a,o)=>{"use strict";var t;o.d(a,{n:()=>t}),function(e){e["CEDULA"]="Cédula de ciudadanía",e["PEP"]="Permiso especial de permanencia"}(t||(t={}))},16496:(e,a,o)=>{"use strict";function t(e){return[...e].reduce(((e,a)=>a.charCodeAt(0)+((e<<5)-e)),0)%360}function r(e){return`hsl(${t(e)}, 80%, 80%)`}o.d(a,{dF:()=>r})},85944:(e,a,o)=>{"use strict";function t(e){if(!e)return"";let a=Math.floor((+Date.now()-e)/1e3),o="segundo",t="Hace";a<0&&(a=-a,t="Dentro de");let r=a;return a>=31536e3?(r=Math.floor(a/31536e3),o="año"):a>=86400?(r=Math.floor(a/86400),o="dia"):a>=3600?(r=Math.floor(a/3600),o="hora"):a>=60&&(r=Math.floor(a/60),o="minuto"),1!=r&&(o+="s"),`${t} ${r} ${o}`}function r(e){if(!e)return"";let a=Math.floor((+Date.now()-e)/1e3),o="segundo";a<0&&(a=-a);let t=a;return a>=31536e3?(t=Math.floor(a/31536e3),o="año"):a>=86400?(t=Math.floor(a/86400),o="dia"):a>=3600?(t=Math.floor(a/3600),o="hora"):a>=60&&(t=Math.floor(a/60),o="minuto"),1!=t&&(o+="s"),`${t} ${o}`}function l(e){return e?e.toDate?e.toDate():e:null}o.d(a,{Cr:()=>t,Vj:()=>r,VP:()=>l})},36496:(e,a,o)=>{"use strict";o.d(a,{s:()=>t});const t=[{icon:"cases",label:"Casos",separator:!0,to:"/cases",requiredPermissions:["cases.read"]},{icon:"podcasts",label:"Podcasts",separator:!0,to:"/podcast",requiredPermissions:["podcasts.read"]},{icon:"warning",label:"Alertas",separator:!0,to:"/alerts",requiredPermissions:["alerts.read"]},{icon:"verified",label:"Permisos",separator:!0,to:"/admin/permissions",requiredPermissions:["admin"]},{icon:"supervised_user_circle",label:"Roles",separator:!0,to:"/admin/user-roles",requiredPermissions:["admin"]},{icon:"how_to_reg",label:"Registrar Usuarios",separator:!0,to:"/register-user",requiredPermissions:["users.write"]},{icon:"question_answer",label:"Mensajes",separator:!0,to:"/messages"},{icon:"person",label:"Mi perfil",separator:!0,to:"/profile"}]},1906:(e,a,o)=>{"use strict";o.d(a,{Z:()=>R});var t=o(83673),r=o(12730);const l=(0,t._)("div",{class:"text-h6 ellipsis"},"Crear Nueva Alerta ⚠️",-1),s={key:0,class:"col-12"},i=(0,t._)("p",{class:"text-caption q-my-sm"},"Caso relacionado:",-1);function n(e,a,o,n,c,u){const d=(0,t.up)("q-card-section"),p=(0,t.up)("q-input"),m=(0,t.up)("q-select"),v=(0,t.up)("q-separator"),g=(0,t.up)("case-card-vue"),f=(0,t.up)("q-btn"),h=(0,t.up)("q-card-actions"),b=(0,t.up)("q-form"),C=(0,t.up)("q-card"),w=(0,t.up)("q-dialog");return(0,t.wg)(),(0,t.j4)(w,{ref:"dialogRef",onHide:e.onDialogHide},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{class:"full-width",bordered:""},{default:(0,t.w5)((()=>[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[l])),_:1}),(0,t.Wm)(b,{onSubmit:(0,r.iM)(e.submit,["prevent"])},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{class:"row q-col-gutter-sm"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{class:"col-12",type:"text",label:"Contacto de emergencia",outlined:"",modelValue:e.alert.emergencyContact,"onUpdate:modelValue":a[0]||(a[0]=a=>e.alert.emergencyContact=a),mask:"phone","unmasked-value":"",rules:[e=>!!e||"Este campo es requerido"]},null,8,["modelValue","rules"]),(0,t.Wm)(p,{class:"col-12",type:"textarea",label:"Descripción",outlined:"",maxlength:"2500",counter:"",modelValue:e.alert.description,"onUpdate:modelValue":a[1]||(a[1]=a=>e.alert.description=a),rules:[e=>!!e||"Este campo es requerido"]},null,8,["modelValue","rules"]),(0,t.Wm)(m,{class:"col-12 col-sm-6",label:"Roles",filled:"",modelValue:e.selectedRoles,"onUpdate:modelValue":a[2]||(a[2]=a=>e.selectedRoles=a),options:e.roles,"option-label":"name",clearable:"","use-chips":"",multiple:"",rules:[e=>e.length>0||"Este campo es requerido"]},null,8,["modelValue","options","rules"]),(0,t.Wm)(m,{class:"col-12 col-sm-6",label:"Tipo de alerta",filled:"",modelValue:e.alert.deliveryMethod,"onUpdate:modelValue":a[3]||(a[3]=a=>e.alert.deliveryMethod=a),options:e.alertDeliveries,clearable:"",rules:[e=>!!e||"Este campo es requerido"]},null,8,["modelValue","options","rules"]),e.relatedCase?((0,t.wg)(),(0,t.iD)("div",s,[(0,t.Wm)(v),i,(0,t.Wm)(g,{caseProp:e.relatedCase},null,8,["caseProp"])])):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(v),(0,t.Wm)(h,{align:"right"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{color:"negative",onClick:e.onCancelClick,flat:"",label:"Cancelar"},null,8,["onClick"]),(0,t.Wm)(f,{color:"warning",type:"submit",label:"Crear"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["onHide"])}var c,u=o(9594),d=o(91701),p=o(48825);(function(e){e["SMS_ONLY"]="Solo SMS",e["CALL_ONLY"]="Solo llamada",e["BOTH"]="Ambos"})(c||(c={}));var m=o(16423),v=o(94215),g=o(75361),f=o(17079),h=o(12942),b=o(86485);const C=(0,t.aZ)({emits:[...d.Z.emits],props:{relatedCaseID:{type:String,required:!1}},components:{CaseCardVue:b.Z},setup(e){const{dialogRef:a,onDialogHide:o,onDialogOK:t,onDialogCancel:r}=(0,d.Z)(),{relatedCaseID:l}=(0,u.BK)(e),s=(0,u.iH)("cases"),{notify:i}=(0,p.Z)(),n=(0,u.iH)({description:"",targetRoleIDs:[],emergencyContact:"",deliveryMethod:c.SMS_ONLY}),{docData:b}=(0,v.H)(s,l),C=(0,u.iH)([]),w=(0,u.iH)(!1),{roles:P}=(0,m.dc)();function q(){const e=(0,g.v0)().currentUser;if(!e)return void i({type:"negative",message:"No hay un usuario logueado."});w.value=!0;const a={uid:e.uid,email:e.email,displayName:e.displayName},o={...n.value,createdBy:a,createdAt:new Date,targetRoleIDs:C.value.map((e=>e.id))};b.value&&(o.relatedCaseID=b.value.ID),(0,f.ET)((0,f.hJ)(h.db,"alerts"),o).then((()=>{i({type:"positive",message:"Alerta creada con éxito"}),t()})).catch((e=>{console.log(e),i({type:"negative",message:"Error creando alerta."})})).finally((()=>{w.value=!1}))}return{dialogRef:a,onDialogHide:o,onCancelClick:r,alert:n,roles:P,selectedRoles:C,alertDeliveries:Object.values(c),isLoading:w,submit:q,relatedCase:b}}});var w=o(74260),P=o(46778),q=o(10151),y=o(25589),D=o(68689),H=o(64689),_=o(72448),k=o(65869),Z=o(99367),A=o(2165),M=o(7518),I=o.n(M);const O=(0,w.Z)(C,[["render",n]]),R=O;I()(C,"components",{QDialog:P.Z,QCard:q.Z,QCardSection:y.Z,QForm:D.Z,QInput:H.Z,QSelect:_.Z,QSeparator:k.Z,QCardActions:Z.Z,QBtn:A.Z})},86485:(e,a,o)=>{"use strict";o.d(a,{Z:()=>D});var t=o(83673),r=o(82942);const l={class:"column"},s={class:"q-mb-none ellipsis-3-lines"},i={class:"text-caption"},n={class:"q-gutter-x-sm"};function c(e,a,o,c,u,d){const p=(0,t.up)("q-badge"),m=(0,t.up)("q-tooltip"),v=(0,t.up)("q-icon"),g=(0,t.up)("q-avatar"),f=(0,t.up)("q-card-section"),h=(0,t.up)("q-card");return(0,t.wg)(),(0,t.j4)(h,{style:{"max-width":"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"q-pa-sm"},{default:(0,t.w5)((()=>[(0,t._)("div",l,[(0,t._)("p",s,(0,r.zw)(e.caseProp.title),1),(0,t._)("p",i,"Aquí "+(0,r.zw)(e.getTimeIntervalRaw(e.handleFirebaseDate(e.caseProp.lastUpdateState))),1)]),(0,t.Wm)(p,{"text-color":"black",style:(0,r.j5)({backgroundColor:e.getBackgroundColor(e.caseProp.type)})},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.caseProp.type),1)])),_:1},8,["style"]),(0,t._)("div",n,[(0,t.Wm)(v,{name:e.casePriorityProps.icon,color:e.casePriorityProps.color},{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.casePriorityProps.tooltip),1)])),_:1})])),_:1},8,["name","color"]),e.caseProp.assignee?((0,t.wg)(),(0,t.j4)(g,{key:0,size:"xs",style:(0,r.j5)({backgroundColor:e.getBackgroundColor(e.caseProp?.assignee?.email??"")})},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.caseProp?.assignee?.email?.charAt(0)?.toUpperCase())+" ",1),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" Asignado a: "+(0,r.zw)(e.caseProp.assignee.email),1)])),_:1})])),_:1},8,["style"])):(0,t.kq)("",!0)])])),_:1})])),_:1})}var u=o(53786),d=o(16496),p=o(85944);const m=(0,t.aZ)({props:{caseProp:{type:Object,required:!0}},data(){return{test:2}},setup(){return{getBackgroundColor:d.dF,handleFirebaseDate:p.VP,getTimeIntervalRaw:p.Vj}},computed:{casePriorityProps(){switch(this.caseProp.priority){case u.dh.LOW:return{color:"blue",icon:"low_priority",tooltip:"Prioridad baja"};case u.dh.NORMAL:return{color:"green",icon:"lens",tooltip:"Prioridad normal"};case u.dh.HIGH:return{color:"red",icon:"priority_high",tooltip:"Prioridad alta"};default:return{}}}}});var v=o(74260),g=o(10151),f=o(25589),h=o(69721),b=o(24554),C=o(5363),w=o(75096),P=o(7518),q=o.n(P);const y=(0,v.Z)(m,[["render",c]]),D=y;q()(m,"components",{QCard:g.Z,QCardSection:f.Z,QBadge:h.Z,QIcon:b.Z,QTooltip:C.Z,QAvatar:w.Z})},32446:(e,a,o)=>{"use strict";o.d(a,{Z:()=>m});var t=o(83673),r=o(82942);function l(e,a,o,l,s,i){const n=(0,t.up)("q-avatar");return(0,t.wg)(),(0,t.j4)(n,{style:(0,r.j5)({backgroundColor:e.getBackgroundColor(e.email??"")}),class:"text-black"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)((e.email??"A").toUpperCase()[0]),1)])),_:1},8,["style"])}var s=o(16496);const i=(0,t.aZ)({props:{email:{type:String,required:!1}},setup(){return{getBackgroundColor:s.dF}}});var n=o(74260),c=o(75096),u=o(7518),d=o.n(u);const p=(0,n.Z)(i,[["render",l]]),m=p;d()(i,"components",{QAvatar:c.Z})},63343:(e,a,o)=>{e.exports=o.p+"img/app-logo.80052cb6.svg"}}]);