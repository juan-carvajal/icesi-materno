"use strict";(self["webpackChunkicesi_materno"]=self["webpackChunkicesi_materno"]||[]).push([[314],{53786:(e,a,t)=>{var o,l,r;t.d(a,{bl:()=>o,jr:()=>l,dh:()=>r}),function(e){e["MEDICAL"]="Médico",e["ADMINISTRATIVE"]="Administrativo"}(o||(o={})),function(e){e["TODO"]="Por Hacer",e["IN_PROGRESS"]="En Progreso",e["BLOCKED"]="Bloqueados",e["RESOLVED"]="Resueltos"}(l||(l={})),function(e){e[e["LOW"]=0]="LOW",e[e["NORMAL"]=1]="NORMAL",e[e["HIGH"]=2]="HIGH"}(r||(r={}))},16496:(e,a,t)=>{function o(e){return[...e].reduce(((e,a)=>a.charCodeAt(0)+((e<<5)-e)),0)%360}function l(e){return`hsl(${o(e)}, 80%, 80%)`}t.d(a,{dF:()=>l})},44719:(e,a,t)=>{t.d(a,{Z:()=>h});var o=t(83673),l=t(82942);const r={class:"q-mb-none ellipsis-3-lines"},s={class:"q-gutter-x-sm"};function i(e,a,t,i,n,c){const u=(0,o.up)("q-badge"),d=(0,o.up)("q-tooltip"),p=(0,o.up)("q-icon"),m=(0,o.up)("q-avatar"),g=(0,o.up)("q-card-section"),f=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(f,{style:{"max-width":"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"q-pa-sm"},{default:(0,o.w5)((()=>[(0,o._)("p",r,(0,l.zw)(e.caseProp.title),1),(0,o.Wm)(u,{"text-color":"black",style:(0,l.j5)({backgroundColor:e.getBackgroundColor(e.caseProp.type)})},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.caseProp.type),1)])),_:1},8,["style"]),(0,o._)("div",s,[(0,o.Wm)(p,{name:e.casePriorityProps.icon,color:e.casePriorityProps.color},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.casePriorityProps.tooltip),1)])),_:1})])),_:1},8,["name","color"]),(0,o.Wm)(m,{size:"xs",style:(0,l.j5)({backgroundColor:e.getBackgroundColor(e.caseProp.assignee.email)})},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.caseProp.assignee.email[0].toUpperCase())+" ",1),(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Asignado a: "+(0,l.zw)(e.caseProp.assignee.email),1)])),_:1})])),_:1},8,["style"])])])),_:1})])),_:1})}var n=t(53786),c=t(16496);const u=(0,o.aZ)({props:{caseProp:{type:Object,required:!0}},data(){return{test:2}},setup(){return{getBackgroundColor:c.dF}},computed:{casePriorityProps(){switch(this.caseProp.priority){case n.dh.LOW:return{color:"blue",icon:"low_priority",tooltip:"Prioridad baja"};case n.dh.NORMAL:return{color:"green",icon:"lens",tooltip:"Prioridad normal"};case n.dh.HIGH:return{color:"red",icon:"priority_high",tooltip:"Prioridad alta"};default:return{}}}}});var d=t(74260),p=t(10151),m=t(25589),g=t(69721),f=t(24554),b=t(5363),w=t(75096),C=t(7518),v=t.n(C);const y=(0,d.Z)(u,[["render",i]]),h=y;v()(u,"components",{QCard:p.Z,QCardSection:m.Z,QBadge:g.Z,QIcon:f.Z,QTooltip:b.Z,QAvatar:w.Z})},92314:(e,a,t)=>{t.r(a),t.d(a,{default:()=>$});var o=t(83673),l=t(82942);const r=(0,o.Uk)(" Casos "),s={class:"row q-gutter-sm col-grow"},i={class:"text-subtitle2 text-grey text-center ellipsis"};function n(e,a,t,n,c,u){const d=(0,o.up)("q-icon"),p=(0,o.up)("q-toolbar-title"),m=(0,o.up)("q-space"),g=(0,o.up)("q-btn"),f=(0,o.up)("q-toolbar"),b=(0,o.up)("q-linear-progress"),w=(0,o.up)("q-card-section"),C=(0,o.up)("q-separator"),v=(0,o.up)("case-card"),y=(0,o.up)("draggable"),h=(0,o.up)("q-card"),q=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(q,{class:"q-ma-md column"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{class:"text-primary q-px-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"cases"}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(m),(0,o.Wm)(g,{flat:"",round:"",icon:"add",onClick:e.openDialog},null,8,["onClick"])])),_:1}),(0,o._)("div",s,[e.isLoading?((0,o.wg)(),(0,o.j4)(b,{key:0,query:""})):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.caseStates,(a=>((0,o.wg)(),(0,o.j4)(h,{class:"col bg-grey-2",flat:"",key:a},{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o._)("div",i,(0,l.zw)(a),1)])),_:2},1024),(0,o.Wm)(C),(0,o.Wm)(y,{list:e.filteredCases(a),class:"column q-gutter-y-sm q-pa-sm",tag:"div",key:`column-${a}`,group:{name:a,pull:!0,put:!0},"item-key":"ID",animation:120,onChange:t=>e.checkAdd(t,a)},{item:(0,o.w5)((({element:e})=>[(0,o.Wm)(v,{class:"cursor-pointer",caseProp:e},null,8,["caseProp"])])),_:2},1032,["list","group","onChange"])])),_:2},1024)))),128))])])),_:1})}var c,u=t(9594),d=t(53786),p=t(44719),m=t(28127),g=t(12942);function f(e,a){const t=(0,u.iH)([]),l=(0,u.iH)(),r=(0,u.iH)(!1);function s(){l.value&&l.value(),r.value=!0;const o=(0,m.ar)("state",a.value===c.ACTIVE?"!=":"==",d.jr.RESOLVED),s=e.value.length>0?(0,m.IO)((0,m.hJ)(g.db,"cases"),(0,m.ar)("assignee.email","in",e.value.slice(0,10)),o):(0,m.IO)((0,m.hJ)(g.db,"cases"),o);l.value=(0,m.cf)(s,(e=>{t.value=[],e.forEach((e=>{const a=e.data();a.ID=e.id,t.value.push(a)})),r.value=!1}),(e=>{console.log(e),r.value=!1}),(()=>{r.value=!1}))}return(0,o.YP)([e,a],s,{immediate:!0}),{cases:t,isLoading:r}}(function(e){e["ACTIVE"]="Activos",e["ARCHIVED"]="Archivados"})(c||(c={}));var b=t(40470),w=t.n(b),C=t(48825),v=t(48879),y=t(12730);const h={class:"text-h6 ellipsis"};function q(e,a,t,r,s,i){const n=(0,o.up)("q-card-section"),c=(0,o.up)("q-select"),u=(0,o.up)("q-separator"),d=(0,o.up)("q-input"),p=(0,o.up)("q-icon"),m=(0,o.up)("q-item-section"),g=(0,o.up)("q-item-label"),f=(0,o.up)("q-item"),b=(0,o.up)("q-btn"),w=(0,o.up)("q-card-actions"),C=(0,o.up)("q-form"),v=(0,o.up)("q-card"),q=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(q,{ref:"dialogRef",onHide:e.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"full-width",bordered:""},{default:(0,o.w5)((()=>[(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o._)("div",h,(0,l.zw)(e.caseState.ID?"Editar Caso":"Crear Caso")+": "+(0,l.zw)(e.caseState.title),1)])),_:1}),(0,o.Wm)(C,{onSubmit:(0,y.iM)(e.onOKClick,["prevent"])},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{class:"row q-col-gutter-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"col-12",label:"Tipo de caso",options:e.caseTypes,modelValue:e.caseState.type,"onUpdate:modelValue":a[0]||(a[0]=a=>e.caseState.type=a),rules:[e=>!!e||"Este campo es requerido"],filled:""},null,8,["options","modelValue","rules"])])),_:1}),(0,o.Wm)(u,{inset:""}),(0,o.Wm)(n,{class:"row q-col-gutter-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"col-12",type:"text",label:"Título",outlined:"",modelValue:e.caseState.title,"onUpdate:modelValue":a[1]||(a[1]=a=>e.caseState.title=a),maxlength:"50",counter:"",rules:[e=>!!e||"Este campo es requerido"]},null,8,["modelValue","rules"]),(0,o.Wm)(d,{class:"col-12",type:"textarea",label:"Descripción",outlined:"",maxlength:"2500",counter:"",modelValue:e.caseState.description,"onUpdate:modelValue":a[2]||(a[2]=a=>e.caseState.description=a)},null,8,["modelValue"]),(0,o.Wm)(c,{class:"col-12 col-sm-6",label:"Responsable",filled:"",modelValue:e.caseState.assignee,"onUpdate:modelValue":a[3]||(a[3]=a=>e.caseState.assignee=a),onFilter:e.filterFn,options:e.assigneeOptions,"option-label":"email",clearable:""},null,8,["modelValue","onFilter","options"]),(0,o.Wm)(c,{class:"col-12 col-sm-6",label:"Prioridad",filled:"",options:e.casePriorities,"map-options":"",modelValue:e.caseState.priority,"onUpdate:modelValue":a[4]||(a[4]=a=>e.caseState.priority=a),"emit-value":""},(0,o.Nv)({option:(0,o.w5)((e=>[(0,o.Wm)(f,(0,l.vs)((0,o.F4)(e.itemProps)),{default:(0,o.w5)((()=>[(0,o.Wm)(m,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{color:e.opt.color,name:e.opt.icon},null,8,["color","name"])])),_:2},1024),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:2},[Number.isNaN(e.caseState?.priority)?void 0:{name:"prepend",fn:(0,o.w5)((()=>[(0,o.Wm)(p,{color:e.getCasePriorityProps(e.caseState.priority).color,name:e.getCasePriorityProps(e.caseState.priority).icon},null,8,["color","name"])]))}]),1032,["options","modelValue"])])),_:1}),(0,o.Wm)(u),(0,o.Wm)(w,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{color:"negative",onClick:e.onCancelClick,flat:"",label:"Cancelar"},null,8,["onClick"]),(0,o.Wm)(b,{color:"primary",type:"submit",label:"Crear"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["onHide"])}var P=t(91701),Z=t(1794);const W=(0,o.aZ)({props:{targetCase:{type:Object,required:!0}},emits:[...P.Z.emits],setup(e){const a=Object.values(d.bl),t=Object.values(d.jr),o=(0,u.iH)([]),{targetCase:l}=(0,u.BK)(e),r=(0,u.iH)(l.value),{notify:s,loading:i}=(0,C.Z)(),n=(0,Z.$C)(),c=(0,Z.V1)(n,"users-GetCaseAssignableUsers"),{dialogRef:p,onDialogHide:f,onDialogOK:b,onDialogCancel:w}=(0,P.Z)();function v(e){switch(e){case d.dh.LOW:return{color:"blue",icon:"low_priority",label:"Prioridad baja",value:e};case d.dh.NORMAL:return{color:"green",icon:"lens",label:"Prioridad normal",value:e};case d.dh.HIGH:return{color:"red",icon:"priority_high",label:"Prioridad alta",value:e};default:return{color:"purple",icon:"question_mark",label:"Prioridad desconocida",value:e}}}const y=(0,u.Fl)((()=>Object.keys(d.dh).filter((e=>!isNaN(Number(e)))).map((e=>v(Number(e)))))),h=()=>(0,m.ET)((0,m.hJ)(g.db,"cases"),r.value).then((()=>{s({type:"positive",message:"Caso creado con éxito"})})).catch((e=>{console.log(e),s({type:"negative",message:"Error creando caso."})}));return{dialogRef:p,onDialogHide:f,onOKClick(){i.show(),h().finally((()=>{i.hide(),b()}))},onCancelClick:w,caseTypes:a,caseStates:t,caseState:r,casePriorities:y,getCasePriorityProps:v,assigneeOptions:o,filterFn(e,a){0===o.value.length?c().then((e=>{o.value=e.data})).then((()=>{a()})):a()}}}});var S=t(74260),_=t(46778),k=t(10151),O=t(25589),I=t(68689),Q=t(63314),D=t(65869),A=t(64689),H=t(83414),V=t(52035),j=t(24554),E=t(2350),L=t(99367),N=t(48240),T=t(7518),R=t.n(T);const x=(0,S.Z)(W,[["render",q]]),U=x;R()(W,"components",{QDialog:_.Z,QCard:k.Z,QCardSection:O.Z,QForm:I.Z,QSelect:Q.Z,QSeparator:D.Z,QInput:A.Z,QItem:H.Z,QItemSection:V.Z,QIcon:j.Z,QItemLabel:E.Z,QCardActions:L.Z,QBtn:N.Z});const z=(0,o.aZ)({components:{CaseCard:p.Z,draggable:w()},setup(){const e=(0,C.Z)(),a=(0,v.useStore)(),t=(0,u.iH)(Object.values(d.jr)),o=(0,u.iH)(c.ACTIVE),l=(0,u.iH)([]),{cases:r,isLoading:s}=f(l,o);function i(){const t={title:"",type:d.bl.ADMINISTRATIVE,state:d.jr.TODO,created:new Date,lastUpdateState:new Date,reported:{email:a.state.auth.email,uid:a.state.auth.uid},priority:d.dh.NORMAL};e.dialog({component:U,componentProps:{targetCase:t}})}function n(e){return JSON.parse(JSON.stringify(r.value.filter((a=>a.state===e))))}function p(e,a){e.added&&e?.added?.element?.ID&&(0,m.r7)((0,m.JU)(g.db,"cases",e.added.element.ID),{state:a}).catch((e=>{console.log(e)}))}return{caseStates:t,isLoading:s,cases:r,filteredCases:n,checkAdd:p,openDialog:i}}});var M=t(24379),B=t(39570),F=t(13747),G=t(62025),J=t(51598);const K=(0,S.Z)(z,[["render",n]]),$=K;R()(z,"components",{QPage:M.Z,QToolbar:B.Z,QIcon:j.Z,QToolbarTitle:F.Z,QSpace:G.Z,QBtn:N.Z,QLinearProgress:J.Z,QCard:k.Z,QCardSection:O.Z,QSeparator:D.Z})}}]);